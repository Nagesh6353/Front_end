<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>View Submissions</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body class="bg-light">

    <header id="header">
        <nav class="navbar navbar-expand-lg">
            <div class="container-fluid">
                <a class="navbar-brand text-white" href="#">Tecocraft</a>
                <a href="feedbackForm.html" class="btn btn-success">Back to Form</a>
            </div>
        </nav>
    </header>

    <div class="container mt-4">
        <h3>Feedbacks</h3>
        <input id="searchInput" class="form-control mb-3" placeholder="Search by name">

        <table class="table table-bordered bg-white">
            <thead class="table-primary">
                <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Event</th>
                    <th>Rating</th>
                    <th>Comments</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>

        <p id="noData" class="text-center text-muted"></p>
    </div>

    <script>
        class FeedbackViewer {
            constructor() {
                this.data = JSON.parse(sessionStorage.getItem("feedbackData")) || [];
                this.tbody = document.getElementById("tableBody");
                this.noData = document.getElementById("noData");
                this.render(this.data);

                document.getElementById("searchInput")
                    .addEventListener("input", e => this.search(e.target.value));
            }

            render(list) {
                this.tbody.innerHTML = "";
                if (list.length === 0) {
                    this.noData.innerText = "No records found";
                    return;
                }
                this.noData.innerText = "";

                list.forEach((record, index) => {
                    this.tbody.innerHTML += `
            <tr>
              <td>${record.name}</td>
              <td>${record.email}</td>
              <td>${record.event}</td>
              <td>${record.rating}</td>
              <td>${record.coments}</td>
              <td>
                <button class="btn btn-sm btn-danger"
                  onclick="viewer.deleteRecord(${index})">
                  Delete
                </button>
              </td>
            </tr>`;
                });
            }

            search(text) {
                const filtered = this.data.filter(record =>
                    record.name.toLowerCase().includes(text.toLowerCase())
                );
                this.render(filtered);
            }

            deleteRecord(index) {
                if (!confirm("Are you sure you want to delete this record?")) return;
                this.data.splice(index, 1);
                sessionStorage.setItem("feedbackData", JSON.stringify(this.data));
                this.render(this.data);
            }
        }

        const viewer = new FeedbackViewer();
    </script>
</body>

</html>